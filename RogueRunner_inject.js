javascript:(function(k,x,q,u){function p(g){var h=Array.prototype.slice.call(arguments);h.unshift("RogueBM[injection]: ");console.error.apply(console,h)}function y(g,h,e){var b=document.createElement("script");b.setAttribute("type","text/javascript");if(g)b.setAttribute("src",g),b.setAttribute("crossorigin","anonymous"),b.onerror=e;else try{b.appendChild(document.createTextNode(h))}catch(d){b.text=h}return b}function z(g,h){var e=k.RogueBM.xDLStorage;e||p("Error injecting "+g," xDLStorage isn't loaded as a backup either",h);e.getScript(g,function(b){b.error&&p("Error loading script from xDLStorage",b.error);try{document.getElementsByTagName("head")[0].appendChild(y(null,b.data))}catch(d){eval(b)}})}function v(){function g(e,b,d){function r(a){console.log("got message",a);if(d.includes(a.origin)){var c=JSON.parse(a.data);c.error&&p(c.error,a);if(c.ready)console.log("doing preload handlers"),m();else if(null==c.messageID)console.error("need data.messageID for callbacks to function",a);else{var l=t[c.messageID];l?l.method!=l.method?p("methods do not match. Possible security risk"):(l.a&&l.a(c,a),t[c.b]=null,delete t[c.b]):p("no handler found for ",a.messageID,a)}}else console.warn("rejected post message from",a.origin,"Allowed origins are",d,"you attempted",a)}function m(){if(n){for(var a=0;a<n.length;a++)f.postMessage(JSON.stringify(n[a]),"*");n=null}}var f,n=[];h(function(){var a=document.createElement("iframe");a.addEventListener("load",m);a.onerror=function(){alert("yeeeet")};a.src=b;a.style.display="none";a.style.position="absolute";document.body.appendChild(a);try{f=a.contentWindow}catch(c){f=a.contentWindow}a&&a.contentDocument&&f||(f=window.open(b.src||b,"RogueRunner","scrollbars=no, width=1, height=1, top=1, left=1"),f.blur())});var t={};e.addEventListener?e.addEventListener("message",r,!1):e.attachEvent("onmessage",r);this.getScript=function(a,c){this.postMessage({method:"getScript",url:a},c)};this.postMessage=function(a,c){var l=Math.floor(9E9*Math.random())+1E9+"-"+Date.now();a.messageID=l;t[l]={a:c,method:a.method};null!=n?n.push(a):f.postMessage(JSON.stringify(a),"*")}}var h=function(){var e=[],b,d="object"==typeof document&&document,r=d&&d.documentElement.doScroll,m=d&&(r?/^loaded|^c/:/^loaded|^i|^c/).test(d.readyState);return!m&&d&&d.addEventListener("DOMContentLoaded",b=function(){d.removeEventListener("DOMContentLoaded",b);for(m=1;b=e.shift();)b()}),function(f){m?setTimeout(f,0):e.push(f)}}();k.RogueBM.CrossOriginLocalStorage=g;k.RogueBM.xDLStorage=new g(k,"https://ktsuttlemyre.github.io/RogueBookmarklets/RogueRunner.html",["https://ktsuttlemyre.github.io"])}Date.now||(Date.now=function(){return(new Date).getTime()});k.RogueBM=k.RogueBM||{};k.RogueBM.c=u;window.RogueBM.show&&(k.RogueBM.CrossOriginLocalStorage||v(),u||window.RogueBM.show());var w=document.documentElement;q=null!=q&&("all"in w.style||"cssall"in w.style)?"_"+q:"";var A="https://ktsuttlemyre.github.io/RogueBookmarklets/RogueRunner_src"+q+".js?user="+x+"&cmd="+u;setTimeout(function(){z(A)},1);v()})(window,"anonymous","experimental");
